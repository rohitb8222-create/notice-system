<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>सुमित एल्कोप्लास्ट - ऑनलाइन नोटीस जनरेटर</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        body { font-family: 'Arial', sans-serif; background-color: #f0f2f5; padding: 15px; margin: 0; }
        .container { max-width: 800px; background: white; padding: 20px; margin: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header-box { text-align: center; border-bottom: 2px solid #004d99; margin-bottom: 15px; padding-bottom: 10px; }
        .header-box h1 { color: #004d99; margin: 0; font-size: 20px; }
        #status { text-align: center; font-weight: bold; margin-bottom: 10px; font-size: 14px; }
        
        .input-section { display: grid; grid-template-columns: 1fr; gap: 10px; background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #ddd; }
        @media (min-width: 600px) { .input-section { grid-template-columns: 1fr 1fr; } }
        
        label { font-weight: bold; font-size: 13px; color: #444; }
        input, textarea { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .checkbox-group { grid-column: 1 / -1; background: white; padding: 12px; border: 1px solid #eee; }
        .checkbox-group label { font-weight: normal; display: block; margin-bottom: 8px; cursor: pointer; }
        
        button { grid-column: 1 / -1; background: #28a745; color: white; border: none; padding: 15px; cursor: pointer; font-size: 18px; border-radius: 6px; margin-top: 10px; }
        
        /* Print Section Settings */
        #notice-output { display: none; padding: 30px; line-height: 1.5; font-size: 16px; color: black; }
        .letter-header { text-align: center; font-weight: bold; text-decoration: underline; font-size: 18px; margin-bottom: 15px; }
        .sign-area { margin-top: 40px; display: flex; justify-content: space-between; font-weight: bold; }
        .note-section { margin-top: 30px; border-top: 1px dashed #000; padding-top: 8px; font-size: 12px; font-style: italic; color: #333; }
        
        @media print {
            @page { size: A4; margin: 1cm; }
            .input-section, button, .header-box, #status { display: none; }
            body { background: white; padding: 0; }
            .container { box-shadow: none; border: none; max-width: 100%; }
            #notice-output { display: block; }
        }
    </style>
</head>
<body onload="initSheet()">

<div class="container">
    <div class="header-box">
        <h1>सुमित एल्कोप्लास्ट कल्याण एम एस डब्लू प्रा. लि.</h1>
        <p>ऑनलाइन ताकीद पत्र जनरेटर</p>
    </div>

    <div id="status" style="color: blue;">डेटा कनेक्ट होत आहे, कृपया थांबा...</div>

    <div class="input-section">
        <div>
            <label>EMP CODE (तिकीट नंबर):</label>
            <input type="text" id="emp-id" placeholder="ID टाका..." oninput="findEmployee()">
        </div>
        <div>
            <label>पूर्ण नाव:</label>
            <input type="text" id="emp-name" readonly style="background: #e9ecef;">
        </div>
        <div>
            <label>पद (Designation):</label>
            <input type="text" id="emp-desig" readonly style="background: #e9ecef;">
        </div>
        <div>
            <label>शिफ्टची वेळ:</label>
            <input type="text" id="shift-val" placeholder="उदा. सकाळ शिफ्ट">
        </div>
        <div>
            <label>घटनेचा दिनांक:</label>
            <input type="date" id="event-date">
        </div>
        <div>
            <label>पत्राची तारीख:</label>
            <input type="date" id="letter-date">
        </div>

        <div class="checkbox-group" id="reasons">
            <label><strong>गैरवर्तणूकीचे कारण निवडा:</strong></label>
            <label><input type="checkbox" value="सुपरवायजरने सांगीतलेले काम करण्यास नकार दिला"> काम करण्यास नकार</label>
            <label><input type="checkbox" value="सुपरवायजरला न विचारता कामाची जागा सोडली"> कामाची जागा सोडली</label>
            <label><input type="checkbox" value="वरिष्ठ अधिकारी/सहकाऱ्यास अर्वाच्य भाषेत शिवीगाळ केली"> शिवीगाळ / गैरवर्तन</label>
            <label><input type="checkbox" value="गणवेश / सेफ्टी शूज / आयडी कार्ड न घालता कामावर आलात"> युनिफॉर्म/सेफ्टी किट नाही</label>
        </div>

        <div style="grid-column: 1 / -1;">
            <label>इतर काही कारण असल्यास (Manually Type):</label>
            <textarea id="manual-reason" rows="2" placeholder="येथे कारण लिहा..."></textarea>
        </div>

        <button onclick="generateAndPrint()">नोटीस जनरेट करा व प्रिंट करा</button>
    </div>

    <div id="notice-output">
        <center><h2 style="margin: 0;">सुमित एल्कोप्लास्ट कल्याण एम एस डब्लू प्रा. लि.</h2></center>
        <hr>
        <div class="letter-header">सक्त ताकीद पत्र</div>
        <div style="float: right;">दिनांक: <span id="pr-date"></span></div><br>
        <strong>प्रती :</strong> <span id="pr-name"></span><br>
        <strong>हुद्दा :</strong> <span id="pr-desig"></span><br>
        <strong>तिकीट नंबर :</strong> <span id="pr-id"></span><br>
        <p>
            वरिष्ठांच्या अहवालानुसार आपण दिनांक <strong><span id="pr-ev-date"></span></strong> रोजी <strong><span id="pr-shift"></span></strong> मध्ये कामावर असताना खालील गैरवर्तन केले आहे:<br>
            <div id="pr-reasons-list" style="padding-left: 20px; font-weight: bold;"></div>
            <div id="pr-manual" style="padding-left: 20px; font-weight: bold;"></div>
            <br>
            आपले कृत्य गैरवर्तणूकीत मोडत असून आपण कायदेशीर कारवाईस पात्र आहात. व्यवस्थापन आपणास सुधारण्याची एक संधी देऊन <strong>सक्त ताकीद</strong> देत आहे. भविष्यात असे घडल्यास कडक कारवाई केली जाईल.
        </p>
        <div class="sign-area">
            <span>यूनिट ऑफिसर</span>
            <span>सहायक व्यवस्थापक (ऑपरेशन्स)</span>
        </div>
        <div class="note-section">
            <strong>नोट :</strong> सदर ताकीदपत्र व्हॉटसअॅपवर पाठवावे आणि कामावर हजर झाल्यावर सही घेऊन HR कडे जमा करावे.
        </div>
    </div>
</div>

<script>
    let masterData = [];
    
    // --- खालील ओळीत तुमची Google Sheet CSV लिंक पेस्ट करा ---
    const sheetCSV = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSeyEu_N_mJ9UStKc6sXa2jdpMOr6QxviTldIucayGD1fg-ShCDDCdlKcOFcmKPtBt8LJpcWRLLnsSF/pub?output=csvा"; 

    function initSheet() {
        Papa.parse(sheetCSV, {
            download: true,
            header: true,
            complete: function(results) {
                masterData = results.data;
                document.getElementById('status').innerText = "डेटा यशस्वीरित्या कनेक्ट झाला! ✅";
                document.getElementById('status').style.color = "green";
            },
            error: function() {
                document.getElementById('status').innerText = "डेटा कनेक्ट झाला नाही. लिंक तपासा.";
                document.getElementById('status').style.color = "red";
            }
        });
    }

    function findEmployee() {
        const id = document.getElementById('emp-id').value.trim();
        // तुमच्या शीटमध्ये कॉलमचे नाव 'EMP CODE' असेच असावे
        const emp = masterData.find(row => row['EMP CODE'] == id);
        if(emp) {
            document.getElementById('emp-name').value = emp['FULL NAME'];
            document.getElementById('emp-desig').value = emp['DESIGNATION'];
        }
    }

    function generateAndPrint() {
        const name = document.getElementById('emp-name').value;
        if(!name) { alert("कृपया तिकीट नंबर तपासा."); return; }

        document.getElementById('pr-date').innerText = document.getElementById('letter-date').value;
        document.getElementById('pr-name').innerText = name;
        document.getElementById('pr-desig').innerText = document.getElementById('emp-desig').value;
        document.getElementById('pr-id').innerText = document.getElementById('emp-id').value;
        document.getElementById('pr-shift').innerText = document.getElementById('shift-val').value;
        document.getElementById('pr-ev-date').innerText = document.getElementById('event-date').value;

        let sel = [];
        document.querySelectorAll('#reasons input:checked').forEach(i => sel.push("• " + i.value));
        document.getElementById('pr-reasons-list').innerHTML = sel.join("<br>");
        
        const man = document.getElementById('manual-reason').value;
        document.getElementById('pr-manual').innerText = man ? "• " + man : "";

        window.print();
    }
</script>
</body>
</html>
